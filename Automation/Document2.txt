IF NOT EXISTS(select 1 from cattle_info_tbl where animal_id=input_calf_id_at_birth) THEN
#insert basic cowinformation in cattle_info_table
INSERT into cattle_info_tbl(herd_id,cow_id,birth_date,breed,reg_no,reg_name,elec_id,sire_id,dam_id,sex) 
values(input_herd_id,input_cow_id,input_birth_date,input_breed,input_reg_num,input_reg_name,input_elec_id,input_sire_id,input_dam_id,'2');
SET @my_chaps_id= LAST_INSERT_ID();
#update this cow's mother's chaps id in the table based on the mother's calf id
Update cattle_info_tbl a join cattle_info_tbl b on a.dam_id=b.animal_id  set a.cow_chaps_id=b.chaps_id where chaps_id= @my_chaps_id;
#update this calf's father's chaps id in the table based on the father's calf id
Update cattle_info_tbl a join cattle_info_tbl b on a.sire_id=b.animal_id  set a.sire_chaps_id=b.chaps_id where chaps_id= @my_chaps_id;
#Update the cow_age for this calf entry
Update cattle_info_tbl a join cattle_info_tbl b on a.dam_id=b.animal_id  set a.cow_age=(Curdate()-b.birth_date) where chaps_id= @my_chaps_id;
#insert the newly generated chaps id and the calf name for this cow in cattle names table if the cow is new to the system
IF NOT ISNULL(input_calf_id_at_birth) THEN 
	insert into cattle_names_tbl(chaps_id,entry_date,cattle_name,entry_type) values( @my_chaps_id,CURDATE(),input_calf_id_at_birth,'CA');
END IF;
#insert the newly generated chaps id and cow name for this cow in cattle names table if the cow is new to the system
insert into cattle_names_tbl(chaps_id,entry_date,cattle_name,entry_type) values( @my_chaps_id,CURDATE(),input_cow_id,'CO');
#INSERT THE CHAPS_ID, BIRTH DATE as entry date and herd ID into ownser_table
insert into owners_tbl(chaps_id,start_date,herd_id,active_flag,animal_source) values(LAST_INSERT_ID(),input_date_entered_herd,herd_id,input_active_flag,input_animal_source);
#insert calf's birth notes to notes table
INSERT into notes_tbl(chaps_id,entry_date,note_type,notes) values(LAST_INSERT_ID(),CURDATE(),'cp',profile_notes);
#check if the user enters the cull information, if yes, enter it into the cull_tbl
IF NOT ISNULL(input_date_culled) THEN
	INSERT into cull_tbl(chaps_id,cow_id,cull_date,cull_code,cull_comments) values(@my_chaps_id,input_cow_id,input_date_culled,input_reason_culled,input_cull_comments);
END IF;
	END IF;